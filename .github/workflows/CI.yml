name: CI

on: push

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: ğŸ³ Run containers
      run: |
        make build
        make run

    - name: ğŸ“š Validate composer.json and composer.lock
      run: make composer-validate

    - name: ğŸ“– Install dependencies
      run: make composer-install
    
    - name: ğŸ“” Linter
      run: make lint

    - name: ğŸ“‚ Wait for database
      run: sleep 30

    - name: ğŸ§ª Test
      run: make test
